---
trigger: manual
---

# 开发需求规范 v1.1
# ============================================
# AI 辅助开发的编码规则和要求
# 生成代码时严格遵循这些规则
#
# 使用方法：
# 1. 将此文件放在项目根目录
# 2. 在 AI 对话中使用 @requirements-spec.zh-CN.txt 引用
# 3. AI 将自动遵循这些规则
#
# 适用范围：所有编程语言和框架
# 最后更新：2025-11-09
# ============================================

## [规则 1] 生成完整可运行代码（优先级：关键）
# 生成完整、可执行的代码，不使用占位符

- 代码必须可立即执行，不允许使用占位符
- 包含所有必要的 import、依赖和配置
- 提供完整实现，不是部分代码片段
- 不允许有不完整的函数或缺失的逻辑
- 不允许 TODO 注释或"稍后实现"的说明

后果：
- 占位或部分代码导致运行时失败和返工
- 缺少 import/配置会造成构建中断和部署延迟

示例：
❌ 错误：
  function processData() {
    // TODO: implement this
  }

✅ 正确：
  function processData(data: string[]): ProcessedData {
    return data.map(item => ({
      id: generateId(),
      value: item.trim(),
      timestamp: Date.now()
    }));
  }

## [规则 2] 复用现有代码和 API（优先级：高）
# 创建新接口前必须先复用现有接口和 API

- 创建新接口前检查现有代码库
- 不要重复发明已有功能
- 引用并使用当前的 API 端点
- 保持与现有接口的兼容性
- 首先搜索类似的实现

示例：
❌ 错误：
  // Creating new validation function
  function validateUser(user) {
    // custom validation logic
  }

✅ 正确：
  // Use existing validation service
  import { validateUser } from '@/services/auth';
  validateUser(user);

## [规则 3] 最小化新增依赖（优先级：高）
# 优先使用项目现有依赖

- 优先使用项目现有依赖
- 添加新依赖需要充分理由
- 添加前检查 package.json/requirements.txt
- 优先使用内置库而非外部包
- 当存在简单的原生解决方案时，避免使用重量级依赖

示例：
❌ 错误：
  import moment from 'moment';  // Heavy new dependency
  moment(date).format('YYYY-MM-DD');

✅ 正确：
  // Use native API
  new Date(date).toISOString().split('T')[0];

## [规则 4] 从之前的错误中学习（优先级：高）
# 不要重复对话历史中的错误

- 实现前参考对话历史
- 避免犯同样的错误两次
- 在所有代码中一致地应用修正
- 记住用户反馈和偏好

## [规则 5] 仅修改请求的内容（优先级：高）
# 只修改明确要求的内容 - 不要未经授权重构

- 未经许可不要重构可工作的代码
- 除非被要求改进，否则保持原有逻辑
- 严格遵守具体任务要求
- 最小化修改范围
- 保留现有代码结构

后果：
- 非请求的重构引入回归并拖慢评审
- 修改范围膨胀增加成本且影响进度

示例（用户只要求修改按钮颜色）：
❌ 错误：
  // Refactoring entire component architecture
  // Switching to Context API
  // Adding performance optimizations

✅ 正确：
  // Only change button color
  <button style={{ backgroundColor: 'blue' }}>Submit</button>

## [规则 6] 验证所有 API 是否存在（优先级：关键）
# 不要发明不存在的 API 或方法

- 使用前验证 API 是否存在
- 查阅文档确认正确的 API 签名
- 只使用已确认可用的 API
- 不要编造虚构的库方法
- 测试 API 与项目版本的兼容性

后果：
- 使用不存在或不兼容的 API 会导致崩溃与支持负担
- 错误签名可能造成数据悄然损坏

示例：
❌ 错误：
  array.removeAt(index);  // Non-existent method

✅ 正确：
  array.splice(index, 1);  // Standard method

## [规则 7] 第一次就完全修复错误（优先级：高）
# 解决根本原因，而不是症状

- 提交前测试解决方案
- 提供可工作的修复，而不是迭代尝试
- 解决根本原因，而不仅仅是症状
- 确保代码在交付前能编译和运行

## [规则 8] 保持注释与代码一致（优先级：中）
# 确保注释与实际实现匹配

- 代码变更时更新注释
- 提供准确、真实的文档
- 不要有误导性或过时的注释
- 注释应反映实际行为

示例：
❌ 错误：
  // Get user list
  function deleteUser(id) { ... }  // Comment doesn't match

✅ 正确：
  // Delete specified user
  function deleteUser(id) { ... }

## [规则 9] 功能优先于完美（优先级：中）
# 优先让代码运行起来

- 可工作的代码 > 完美的代码
- 功能优先于优化
- 先交付 MVP 再做增强
- 先让它运行，然后再改进

## [规则 10] 确保代码成功编译（优先级：关键）
# 所有代码必须能编译/运行且无错误

- 交付前检查语法
- 解决所有编译错误
- 测试构建过程
- 验证 import 和依赖是否正确

后果：
- 构建失败会阻塞交付流水线
- 运行时错误会降低用户体验与信任

## [规则 11] 严格遵循提供的示例（优先级：中）
# 当给出示例时，精确匹配它们

- 匹配示例的代码风格
- 使用相同的模式和结构
- 与提供的样本保持一致
- 复制结构和命名约定

## [规则 12] 尊重项目命名约定（优先级：中）
# 保留现有的命名模式

- 未经许可不要重命名变量/函数
- 遵循项目的命名风格
- 与代码库保持一致
- 匹配现有模式（camelCase、snake_case 等）

## [规则 13] 只使用真实存在的库（优先级：关键）
# 只导入实际存在的库

- 导入前验证包是否存在
- 不要使用虚构或编造的包
- 检查 npm/pip/package 注册表
- 确认库版本兼容性

后果：
- 导入虚构或错误版本的库会导致构建失败
- 未审查的包可能带来安全风险

示例：
❌ 错误：
  import { magicHelper } from 'super-magic-lib';  // Doesn't exist

✅ 正确：
  import { useState } from 'react';  // Real library

# ============================================
# 摘要 - 关键规则（最高优先级）
# ============================================

1. 生成完整、可运行的代码（无 TODO、无占位符）
2. 复用现有接口/API - 不要不必要地创建新接口
3. 最小化依赖 - 使用已有的
4. 只修改请求的内容 - 不要未经授权重构
5. 使用前验证所有 API 是否存在
6. 代码必须能立即编译和运行
7. 从对话中的错误中学习
8. 只使用真实存在的库
9. 严格遵循提供的示例
10. 保持注释与实现一致

# ============================================
# 使用方法
# ============================================
# 在 AI 对话中引用此文件：
#   "@requirements-spec.zh-CN.txt 实现用户登录"
#
# 或在项目 README 中说明：
#   "本项目使用 requirements-spec.zh-CN.txt 作为 AI 代码生成标准"
#
# ============================================
# 项目类型配置
# ============================================
# 不同项目类型推荐启用的规则集合

Web 应用：
- 启用： [规则 1, 2, 3, 5, 6, 7, 10, 11, 12, 13]
- 可选： [规则 8, 9]
- 说明：Web 应用需要完整性、API 准确性、快速修复，以及编译/运行保证；注释与示例提升协作效率。

CLI 工具：
- 启用： [规则 1, 2, 3, 5, 6, 7, 10, 12, 13]
- 可选： [规则 8, 9, 11]
- 说明：CLI 更强调可靠性、最小依赖、稳定运行于多环境。

库/SDK：
- 启用： [规则 1, 2, 3, 6, 7, 10, 12, 13]
- 可选： [规则 5, 8, 9, 11]
- 说明：库强调 API 正确性、版本纪律、完整性与高质量错误处理，同时尽量减少依赖。

# ============================================
# 版本历史
# ============================================
# v1.1 (2025-11-09) - 精简至 13 条核心规则，移除语言特定要求
# v1.0 (2025-11-09) - 基于用户反馈数据的初始版本
# ============================================
