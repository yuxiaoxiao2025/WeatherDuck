# 🚀 天气鸭预览环境一键配置指南

## 📋 配置清单

为了让您快速完成天气鸭预览环境的配置，我已经为您准备了所有必要的信息和步骤。

### ✅ 已完成的配置

1. **GitHub Actions 工作流** - 已优化并配置完成
2. **Vercel 部署配置** - vercel.json 已更新
3. **环境变量模板** - .env.example 已更新为您的 API 信息
4. **部署文档** - 完整的配置指南已创建

### 🔧 您需要完成的配置

## 步骤 1: 创建本地环境文件

```bash
# 在项目根目录执行
cp .env.example .env.local
```

现在 `.env.local` 文件已包含您的 API 配置：
- API Key: `6b95a713b2854ca0b5b62ac9d9cca3bb`
- API Host: `https://nd2r6wuqd7.re.qweatherapi.com`
- 凭据 ID: `CGPNGJKBU6`

## 步骤 2: 获取 Vercel 配置信息

### 2.1 获取 Vercel Token
1. 访问 https://vercel.com/dashboard
2. 点击右上角头像 → Settings → Tokens
3. 创建新 Token，名称：`weather-duck-deploy`
4. 复制生成的 Token

### 2.2 创建 Vercel 项目
1. 在 Vercel Dashboard 点击 "New Project"
2. 导入您的 GitHub 仓库
3. 项目名称设置为：`weather-duck-preview`
4. Framework Preset 选择：`Vite`
5. Build Command: `npm run build:web-preview`
6. Output Directory: `dist-web`
7. 点击 "Deploy"

### 2.3 获取项目信息
部署完成后，在项目设置页面获取：
- **Organization ID**: Settings → General → Team ID
- **Project ID**: Settings → General → Project ID

## 步骤 3: 配置 GitHub Secrets

在您的 GitHub 仓库中：Settings → Secrets and variables → Actions

添加以下 6 个 Repository Secrets：

```
VERCEL_TOKEN = [步骤2.1中获取的Token]
VERCEL_ORG_ID = [步骤2.3中获取的Organization ID]
VERCEL_PROJECT_ID = [步骤2.3中获取的Project ID]
QWEATHER_API_KEY = 6b95a713b2854ca0b5b62ac9d9cca3bb
QWEATHER_API_HOST = https://nd2r6wuqd7.re.qweatherapi.com
QWEATHER_CREDENTIAL_ID = CGPNGJKBU6
```

## 步骤 4: 配置 Vercel 环境变量

在 Vercel 项目中：Settings → Environment Variables

添加以下环境变量（所有环境都选择）：

```
VITE_QWEATHER_API_KEY = 6b95a713b2854ca0b5b62ac9d9cca3bb
VITE_WEATHER_API_BASE_URL = https://nd2r6wuqd7.re.qweatherapi.com
VITE_QWEATHER_CREDENTIAL_ID = CGPNGJKBU6
```

## 步骤 5: 触发首次部署

```bash
# 提交一个小的更改来触发部署
git add .
git commit -m "配置预览环境部署"
git push origin main
```

## 🎯 验证部署

### 1. 本地验证
```bash
# 安装依赖
npm install

# 构建 Web 预览版
npm run build:web-preview

# 本地预览
npm run preview:web
```

### 2. 在线验证
- 访问：https://weather-duck-preview.vercel.app
- 检查天气数据是否正常加载
- 验证 API 调用是否成功

## 📊 配置状态检查

### GitHub Actions
- ✅ 工作流文件已配置
- ⏳ 等待您配置 Secrets
- ⏳ 等待首次推送触发

### Vercel 部署
- ⏳ 等待您创建项目
- ⏳ 等待您配置环境变量
- ⏳ 等待首次部署

### API 配置
- ✅ API 密钥已配置
- ✅ API 主机已配置
- ✅ 凭据 ID 已配置

## 🔍 故障排除

### 如果部署失败
1. 检查 GitHub Actions 日志
2. 验证所有 Secrets 是否正确配置
3. 确认 Vercel 项目配置正确

### 如果 API 调用失败
1. 验证和风天气 API 密钥是否有效
2. 检查 API 主机地址是否正确
3. 确认环境变量在 Vercel 中正确配置

### 快速测试 API
```bash
# 测试 API 连接
curl "https://nd2r6wuqd7.re.qweatherapi.com/v7/weather/now?location=101010100&key=6b95a713b2854ca0b5b62ac9d9cca3bb"
```

## 📞 需要帮助？

如果在配置过程中遇到任何问题，请：

1. 查看详细的配置指南：`GITHUB_SECRETS_配置指南.md`
2. 检查部署文档：`DEPLOYMENT.md`
3. 查看平台部署指南：`PLATFORM_DEPLOYMENT_GUIDE.md`

## 🎉 配置完成后

一旦所有配置完成，您将拥有：

- ✅ 自动化的预览环境部署
- ✅ 每次推送代码自动更新预览
- ✅ 完整的天气数据 API 集成
- ✅ 现代化的 Web 应用预览

**预览地址**: https://weather-duck-preview.vercel.app

---

**预计配置时间**: 15-20 分钟
**技术支持**: 所有配置文件和脚本已准备就绪